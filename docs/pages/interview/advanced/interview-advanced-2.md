# åŸç†-æµè§ˆå™¨æ¸²æŸ“åŸç†

## åŸºæœ¬æ¦‚å¿µä¿¡æ¯
- ä»€ä¹ˆæ˜¯æµè§ˆå™¨çš„æ¸²æŸ“
  - åœ¨æµè§ˆå™¨ä¸­,å°†htmlå­—ç¬¦ä¸²,è½¬åŒ–æˆåƒç´ ä¿¡æ¯,è¿™ä¸ªè¿‡ç¨‹å°±å«æ¸²æŸ“
  - åªè¦å°†è¿™äº›åƒç´ ç‚¹çš„é¢œè‰²äº¤ç»™gpu,äº¤ç»™æ˜¾å¡,å°±ä¼šåœ¨å±å¹•ä¸Šæ˜¾ç¤ºå‡ºæ¥,å°±å®Œæˆäº†ä¸€æ¬¡æ¸²æŸ“
    ```js
    const render = (html) => {
        // å±å¹•ä¸Šç¬¬ä¸€ä¸ªçš„ç¬¬ä¸€ä¸ªåƒç´ ç‚¹ä»€ä¹ˆé¢œè‰²,ç¬¬äºŒä¸ªåƒç´ ç‚¹ä»€ä¹ˆé¢œè‰²
        // ç¬¬äºŒè¡Œ.......

        return pixels;
    }
    ```

## é¢è¯•é¢˜
### ä»æµè§ˆå™¨è¾“å…¥åˆ°é¡µé¢å±•ç¤ºå‘ç”Ÿäº†ä»€ä¹ˆ
> ä¸»è¦å‘ç”Ÿçš„äº‹æƒ…åœ¨ç½‘ç»œå’Œæ¸²æŸ“ä¸¤ä¸ªå±‚é¢,åé¢æˆ‘ä»¬ä¸»è¦è®²æ¸²æŸ“
- ç½‘ç»œ
  - æµè§ˆå™¨çš„ç½‘ç»œè¿›ç¨‹ä¼šå¼€ä¸€ä¸ªç½‘ç»œçº¿ç¨‹,å»è¯·æ±‚è¿™ä¸ªèµ„æº,å»æ‹¿htmlå­—ç¬¦ä¸²
  - è¿™ä¸ªç½‘ç»œçº¿ç¨‹ä¼šç”Ÿæˆä¸€ä¸ªæ¸²æŸ“ä»»åŠ¡ç»™æ¸²æŸ“è¿›ç¨‹ä¸­çš„æ¸²æŸ“ä¸»çº¿ç¨‹ä¸­çš„æ¶ˆæ¯é˜Ÿåˆ—,å°±å¯åŠ¨äº†ä¸€ä¸ªæ¸²æŸ“æµç¨‹
- ä¸‹é¢å¼€å§‹ä¸“é¢˜è®²è§£æ¸²æŸ“æµç¨‹

## æ¸²æŸ“
> æµè§ˆå™¨æ˜¯å¦‚ä½•æ¸²æŸ“é¡µé¢çš„ï¼Ÿ
- å½“æµè§ˆå™¨çš„ç½‘ç»œçº¿ç¨‹æ”¶åˆ° HTML æ–‡æ¡£åï¼Œä¼šäº§ç”Ÿä¸€ä¸ªæ¸²æŸ“ä»»åŠ¡ï¼Œå¹¶å°†å…¶ä¼ é€’ç»™æ¸²æŸ“ä¸»çº¿ç¨‹çš„æ¶ˆæ¯é˜Ÿåˆ—ã€‚(ğŸŒŸ)
- åœ¨äº‹ä»¶å¾ªç¯æœºåˆ¶çš„ä½œç”¨ä¸‹ï¼Œæ¸²æŸ“ä¸»çº¿ç¨‹å–å‡ºæ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„æ¸²æŸ“ä»»åŠ¡ï¼Œå¼€å¯æ¸²æŸ“æµç¨‹
- ---
- æ•´ä¸ªæ¸²æŸ“æµç¨‹åˆ†ä¸ºå¤šä¸ªé˜¶æ®µï¼Œåˆ†åˆ«æ˜¯: HTML è§£æã€æ ·å¼è®¡ç®—ã€å¸ƒå±€ã€åˆ†å±‚ã€ç»˜åˆ¶ã€åˆ†å—ã€å…‰æ …åŒ–ã€ç”»(ğŸŒŸ)
- æ¯ä¸ªé˜¶æ®µéƒ½æœ‰æ˜ç¡®çš„è¾“å…¥è¾“å‡ºï¼Œä¸Šä¸€ä¸ªé˜¶æ®µçš„è¾“å‡ºä¼šæˆä¸ºä¸‹ä¸€ä¸ªé˜¶æ®µçš„è¾“å…¥ã€‚
- è¿™æ ·ï¼Œæ•´ä¸ªæ¸²æŸ“æµç¨‹å°±å½¢æˆäº†ä¸€å¥—ç»„ç»‡ä¸¥å¯†çš„ç”Ÿäº§æµæ°´çº¿ã€‚
- æœ€ç»ˆçš„ç›®çš„æ˜¯ç”Ÿæˆä¸€ä¸ªä¸ªåƒç´ ç‚¹çš„é¢œè‰²ä¿¡æ¯ï¼Œäº¤ç»™ GPU åˆæˆå™¨ï¼Œæœ€ç»ˆå‘ˆç°åœ¨å±å¹•ä¸Šã€‚

### ç¬¬ä¸€é˜¶æ®µ: è§£æHTML(ç”ŸæˆDOMæ ‘å’ŒCSSOMæ ‘)
- æ¸²æŸ“çš„ç¬¬ä¸€æ­¥æ˜¯è§£æ HTML
- è§£æè¿‡ç¨‹ä¸­é‡åˆ° CSS è§£æ CSSï¼Œé‡åˆ° JS æ‰§è¡Œ JSã€‚ä¸ºäº†æé«˜è§£ææ•ˆç‡ï¼Œæµè§ˆå™¨åœ¨å¼€å§‹è§£æå‰ï¼Œä¼šå¯åŠ¨ä¸€ä¸ªé¢„è§£æçš„çº¿ç¨‹ï¼Œç‡å…ˆä¸‹è½½ HTMLä¸­çš„å¤–éƒ¨ CSS æ–‡ä»¶å’Œ å¤–éƒ¨çš„ JS æ–‡ä»¶ã€‚
- å¦‚æœä¸»çº¿ç¨‹è§£æåˆ° link ä½ç½®ï¼Œæ­¤æ—¶å¤–éƒ¨çš„ CSS æ–‡ä»¶è¿˜æ²¡æœ‰ä¸‹è½½è§£æå¥½ï¼Œä¸»çº¿ç¨‹ä¸ä¼šç­‰å¾…ï¼Œç»§ç»­è§£æåç»­çš„HTMLã€‚è¿™æ˜¯å› ä¸ºä¸‹è½½å’Œè§£æ CSS çš„å·¥ä½œæ˜¯åœ¨é¢„è§£æçº¿ç¨‹ä¸­è¿›è¡Œçš„ã€‚è¿™å°±æ˜¯ CSS ä¸ä¼šé˜»å¡ HTML è§£æçš„æ ¹æœ¬åŸå› ã€‚
- å¦‚æœä¸»çº¿ç¨‹è§£æåˆ° script ä½ç½®ï¼Œä¼šåœæ­¢è§£æ HTMLï¼Œè½¬è€Œç­‰å¾… JS æ–‡ä»¶ä¸‹è½½å¥½ï¼Œå¹¶å°†å…¨å±€ä»£ç è§£ææ‰§è¡Œå®Œæˆåï¼Œæ‰èƒ½ç»§ç»­è§£æ HTMLã€‚è¿™æ˜¯å› ä¸º JS ä»£ç çš„æ‰§è¡Œè¿‡ç¨‹å¯èƒ½ä¼šä¿®æ”¹å½“å‰çš„ DOM æ ‘ï¼Œæ‰€ä»¥ DOM æ ‘çš„ç”Ÿæˆå¿…é¡»æš‚åœã€‚è¿™å°±æ˜¯ JS ä¼šé˜»æ´ HTML è§£æçš„æ ¹æœ¬åŸå› ã€‚
- ç¬¬ä¸€æ­¥å®Œæˆåï¼Œä¼šå¾—åˆ° DOM æ ‘å’Œ CSSOM æ ‘ï¼Œæµè§ˆå™¨çš„é»˜è®¤æ ·å¼ã€å†…éƒ¨æ ·å¼ã€å¤–éƒ¨æ ·å¼ã€è¡Œå†…æ ·å¼å‡ä¼šåŒ…å«åœ¨ CSSOM æ ‘ä¸­ã€‚
  - è¿™ä¸ªdomæ ‘çš„ä»£ç å®é™…ä¸Šæ˜¯c++ä»£ç ,å¤–é¢åŒ…äº†ä¸€å±‚,jsä»£ç åªæ˜¯ç”¨æ¥æ“ä½œè¿™ä¸ªdomæ ‘
  - å½¢æˆdomæ ‘æ˜¯ä¸ºäº†åç»­çš„å·¥ä½œåšå‡†å¤‡
- è¡¥å……è¯´æ˜: 
  - æœ‰å“ªäº›æ ·å¼è¡¨
    - å†…éƒ¨æ ·å¼è¡¨
    - å¤–éƒ¨æ ·å¼è¡¨
    - å†…è”æ ·å¼è¡¨(è¡Œå†…æ ·å¼è¡¨)
    - æµè§ˆå™¨çš„é»˜è®¤æ ·å¼è¡¨
      - [chromeæµè§ˆå™¨æºä»£ç ](https://github.com/chromium/chromium/blob/main/third_party/blink/renderer/core/html/resources/html.css) 
  - é™¤äº†æµè§ˆå™¨çš„é»˜è®¤æ ·å¼,å…¶ä»–çš„æ ·å¼jséƒ½èƒ½æ“ä½œ
  - styleSheetListå¯¹è±¡
    ```js
    {
        styleSheetList: {
            å†…éƒ¨æ ·å¼è¡¨: {},
            å¤–éƒ¨æ ·å¼è¡¨: {},
            å†…è”æ ·å¼è¡¨: {},
            æµè§ˆå™¨çš„é»˜è®¤æ ·å¼è¡¨: {},
        }
    }
    ```
  - è·å–æ ·å¼è¡¨: `document.styleSheets`
  - å…¨å±€æ·»åŠ æ ·å¼è§„åˆ™: `document.styleSheets[0].addRule("div", "border: solid 1px #f00")`
    - æ¡†æ¶ä¸­ä½¿ç”¨çš„æ¯”è¾ƒå¤š
- é—®é¢˜: 
  - htmlè§£æè¿‡ç¨‹ä¸­é‡åˆ°cssä»£ç æ€ä¹ˆåŠ
    - ä¸ºäº†æé«˜è§£ææ•ˆç‡,æµè§ˆå™¨ä¼šå¯åŠ¨ä¸€ä¸ªé¢„è§£æå™¨(é¢„è§£æçº¿ç¨‹),å…ˆä¸‹è½½å’Œè§£æcssæ–‡ä»¶
  - htmlè§£æè¿‡ç¨‹ä¸­é‡åˆ°jsä»£ç æ€ä¹ˆåŠ
    - æ¸²æŸ“ä¸»çº¿ç¨‹é‡åˆ°jsæ—¶å¿…é¡»æš‚åœä¸€åˆ‡è¡Œä¸º,ç­‰å¾…ä¸‹è½½æ‰§è¡Œå®Œåæ‰èƒ½ç»§ç»­
    - é¢„è§£æçº¿ç¨‹å¯ä»¥åˆ†æ‹…ä¸€ç‚¹ä¸‹è½½jsçš„ä»»åŠ¡
    - å› ä¸ºjså¯èƒ½ä¼šæ”¹åŠ¨å½“å‰çš„html

### ç¬¬äºŒé˜¶æ®µ: æ ·å¼è®¡ç®—
> csså±æ€§å€¼çš„è®¡ç®—è¿‡ç¨‹,å°±æ˜¯æ ·å¼è®¡ç®—
> é€šè¿‡æ ·å¼è®¡ç®—ä¹‹å,å½¢æˆæ–°çš„domæ ‘,è¿™ä¸ªdomæ ‘ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰å¯¹åº”çš„æ ·å¼ä¿¡æ¯(è®¡ç®—åçš„æ ·å¼)
- cssçš„è®¡ç®—æœ‰å“ªäº›æƒ…å†µ
  - å±‚å  => æ ·å¼å†²çªå¦‚ä½•è§£å†³
  - ç»§æ‰¿
- cssçš„è§†è§‰å¯è§†åŒ–æ¨¡å‹
  - ç›’æ¨¡å‹
  - åŒ…å«å—
  - æµå¼å¸ƒå±€
  - æµ®åŠ¨å¸ƒå±€
  - bfc(å—çº§æ ¼å¼åŒ–ä¸Šä¸‹é—®)
- è®¡ç®—åçš„æ ·å¼
  - è¡¨ç¤ºæ‰€æœ‰çš„cssæ ·å¼å…¨éƒ¨æœ‰å€¼ 
  - è°·æ­Œæµè§ˆå™¨æ§åˆ¶å° => stylesæ—è¾¹ => computed =â‰¥ show all => å¯ä»¥çœ‹åˆ°æ‰€æœ‰æ ·å¼(æœ€ç»ˆè®¡ç®—å‡ºæ¥çš„æ ·å¼)
- æ€»ç»“
  - ä¸»çº¿ç¨‹ä¼šéå†å¾—åˆ°domæ ‘,ä¾æ¬¡ä¸ºæ ‘ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹è®¡ç®—å‡ºå®ƒçš„æœ€ç»ˆæ ·å¼,ç§°ä¹‹ä¸º computed style
  - åœ¨è¿™ä¸€è¿‡ç¨‹ä¸­,å¾ˆå¤šé¢„è®¾å€¼ä¼šå˜æˆç»å¯¹å€¼,æ¯”å¦‚redä¼šå˜æˆrgb(255, 0, 0),ç›¸å¯¹å•ä½ä¼šå˜æˆç»å¯¹å•ä½,æ¯”å¦‚1emä¼šå˜æˆ16px
  - è¿™ä¸€æ­¥å®Œæˆå,ä¼šå¾—åˆ°ä¸€æ£µå¸¦æœ‰æ ·å¼çš„domæ ‘
- é€šè¿‡jsè·å–æœ€ç»ˆçš„è®¡ç®—æ ·å¼
  - `document.getComputedStyle()`

### ç¬¬ä¸‰é˜¶æ®µ: å¸ƒå±€
> å¸ƒå±€å°±æ˜¯è®¡ç®—æ¯ä¸ªèŠ‚ç‚¹åœ¨é¡µé¢ä¸Šçš„å°ºå¯¸å’Œä½ç½®
> å®ƒçš„ä½ç½®ç›¸å¯¹çš„æ˜¯åŒ…å«å—
- åŒ…å«å—
  - è¡¨ç¤ºä¸€ä¸ªå…ƒç´ çš„æ´»åŠ¨åŒºåŸŸ
  - æ¯”å¦‚ä¸€ä¸ªdivè®¾ç½®å®½åº¦çš„ç™¾åˆ†æ¯”,å®ƒæ˜¯ç›¸å¯¹äºåŒ…å«å—çš„ç™¾åˆ†æ¯”
- æœ‰äº›æ ·å¼,æ¯”å¦‚auto,ç™¾åˆ†æ¯”,åœ¨ç¬¬äºŒä¸ªé˜¶æ®µæ˜¯æ— æ³•è®¡ç®—å‡ºæ¥çš„,æ‰€ä»¥éœ€è¦ç¬¬ä¸‰ä¸ªé˜¶æ®µ
- layoutæ ‘(å¸ƒå±€æ ‘)
  - domæ ‘å’Œlayoutæ ‘æ˜¯ä¸åŒçš„
  - æœ‰äº›éšè—çš„å…ƒç´ ä¸ä¼šå‡ºç°åœ¨å¸ƒå±€æ ‘é‡Œé¢,å¸ƒå±€æ ‘æ˜¯ä¸ºäº†æ‰¾åˆ°æ¯ä¸ªèŠ‚ç‚¹çš„å‡ ä½•ä¿¡æ¯(å°ºå¯¸å’Œä½ç½®),å³layoutæ ‘ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½å¯¹åº”ä¸€ä¸ªçœŸå®çš„å…ƒç´ ,ä½†æ˜¯display: noneçš„å…ƒç´ æ²¡æœ‰å¯¹åº”çš„èŠ‚ç‚¹
  - headå…ƒç´ æ˜¯éšè—çš„
  - ::beforeå’Œ::afterä¼ªå…ƒç´ åœ¨domæ ‘ä¸­å­˜åœ¨,åœ¨å¸ƒå±€æ ‘ä¸­ä¸å­˜åœ¨
  - å¸ƒå±€æ ‘ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹å’ŒdomèŠ‚ç‚¹å¾ˆåƒ,ä½†ä¸æ˜¯domå¯¹è±¡,æ˜¯ä¸€ä¸ªä¸ªC++å¯¹è±¡,æ˜¯jsè·å–ä¸åˆ°çš„
  - - å¯¹åº”æºç : https://github.com/chromium/chromium/tree/main/third_party/blink/renderer/core/layout
- headå…ƒç´ ä¸ºä»€ä¹ˆæ˜¯éšè—çš„
  - åœ¨è°·æ­Œæµè§ˆå™¨æºç ä¸­,æµè§ˆå™¨çš„é»˜è®¤æ ·å¼è¡¨ä¸­è®¾ç½®çš„æ˜¯`head { display: none }`
- å†…å®¹å¿…é¡»åœ¨è¡Œç›’ä¸­(ğŸŒŸ)
  - è¡Œç›’å—ç›’è¯´çš„æ˜¯ç›’æ¨¡å‹,å†…å®¹å¿…é¡»åœ¨è¡Œç›’ä¸­
  - è¡Œç›’: display: inline
  - å—ç›’: display: block
  - è¡Œçº§å…ƒç´ å—çº§å…ƒç´ è¯´çš„æ˜¯æ ‡ç­¾ç±»å‹å³html,ä¸”è¿™ç§è¯´æ³•å·²ç»è¿‡æ—¶
    - ç›’å­çš„ç±»å‹ç”±csså†³å®š,htmlåªæä¾›è¯­æ„åŒ–
- è¡Œç›’å’Œå—ç›’ä¸èƒ½ç›¸é‚»(ğŸŒŸ)
    - åœ¨HTMLæ–‡æ¡£ä¸­ï¼Œå½“æ–‡æœ¬æˆ–å…¶ä»–è¡Œå†…å†…å®¹æ²¡æœ‰è¢«ä»»ä½•è¡Œå†…å…ƒç´ ï¼ˆå¦‚spanã€aã€strongç­‰ï¼‰åŒ…è£¹æ—¶ï¼ŒCSSå¼•æ“ä¼šè‡ªåŠ¨ä¸ºè¿™äº›å†…å®¹ç”Ÿæˆä¸€ä¸ªæˆ–å¤šä¸ªåŒ¿åè¡Œå†…ç›’å­ï¼Œä»¥ä¾¿è¿›è¡Œå¸ƒå±€å’Œæ¸²æŸ“ã€‚
    - å¦‚æœè¡Œç›’å†…éƒ¨åŒ…å«äº†å—çº§å…ƒç´ ,CSSå¼•æ“å¯èƒ½ä¼šåˆ›å»ºåŒ¿åå—ç›’æ¥åŒ…è£¹è¿™äº›å—çº§å…ƒç´ 
- æ‰€ä»¥æœ‰å¾ˆå¤šç§æƒ…å†µä¼šå¯¼è‡´å¸ƒå±€æ ‘å’Œdomæ ‘ä¸å¯¹åº”
- jså¯ä»¥è·å–éƒ¨åˆ†å¸ƒå±€æ ‘ä¿¡æ¯
  - `document.body.clientWidth`
  - `document.body.clientHeight`
  - `document.documentElement.offsetWidth`
  - ......
- æ€»ç»“
  - å¸ƒå±€å®Œæˆä¹‹åä¼šå¾—åˆ°å¸ƒå±€æ ‘
  - å¸ƒå±€é˜¶æ®µä¼šä¾æ¬¡éå†domæ ‘çš„æ¯ä¸ªèŠ‚ç‚¹,è®¡ç®—æ¯ä¸ªèŠ‚ç‚¹çš„é›†åˆä¿¡æ¯,ä¾‹å¦‚èŠ‚ç‚¹çš„å®½é«˜,ç›¸å¯¹åŒ…å«å—çš„ä½ç½®
  - å¤§éƒ¨åˆ†çš„æ—¶å€™,domæ ‘å’Œå¸ƒå±€æ ‘å¹¶éä¸€ä¸€å¯¹åº”
  - æ¯”å¦‚`display:none`çš„èŠ‚ç‚¹æ²¡æœ‰å‡ ä½•ä¿¡æ¯,å› æ­¤ä¸ä¼šç”Ÿæˆåˆ°å¸ƒå±€æ ‘,åˆæ¯”å¦‚ä½¿ç”¨äº†ä¼ªå…ƒç´ é€‰æ‹©å™¨,è™½ç„¶domæ ‘ä¸­ä¸å­˜åœ¨è¿™äº›ä¼ªå…ƒç´ èŠ‚ç‚¹,ä½†ä»–ä»¬æ‹¥æœ‰å‡ ä½•ä¿¡æ¯,æ‰€ä»¥ä¼šç”Ÿæˆåˆ°å¸ƒå±€æ ‘ä¸­,è¿˜æœ‰åŒ¿åè¡Œç›’,åŒ¿åå—ç›’ç­‰éƒ½ä¼šå¯¼è‡´domæ ‘å’Œå¸ƒå±€æ ‘æ— æ³•ä¸€ä¸€å¯¹åº”

### ç¬¬å››é˜¶æ®µ: åˆ†å±‚
> åœ¨å¸ƒå±€æ ‘ä¸­,æµè§ˆå™¨å…¶å®å·²ç»å¯ä»¥è¿›è¡Œç»˜åˆ¶äº†,ä½†æµè§ˆå™¨çš„é¡µé¢å¹¶ä¸æ˜¯ç¦æ­¢ä¸åŠ¨çš„,ä¸ºäº†æå‡æ¸²æŸ“æ€§èƒ½,æµè§ˆå™¨ä¼šå°†å¸ƒå±€æ ‘åˆ†å±‚,ç„¶ååˆ†åˆ«å¯¹æ¯ä¸€å±‚è¿›è¡Œç»˜åˆ¶(å¦åˆ™æµè§ˆå™¨åªè¦ä¸€ç‚¹æ”¹å˜å°±éœ€è¦ç»˜åˆ¶æ•´ä¸ªé¡µé¢)
> å°†å¸ƒå±€æ ‘ä¸­çš„èŠ‚ç‚¹è¿›è¡Œåˆ†å±‚,å°†é¡µé¢åˆ†æˆå¤šä¸ªå›¾å±‚,æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰å¯¹åº”çš„å±‚,åˆ†åˆ«è¿›è¡Œç»˜åˆ¶(ä»¥å‰çš„æµè§ˆå™¨éƒ½æ²¡æœ‰,ç°åœ¨æµè§ˆå™¨é‡Œé¢å¤§éƒ¨åˆ†éƒ½æœ‰è¿™ä¸ªæ­¥éª¤)
> ç±»ä¼¼å°æ—¶å€™ç©çš„è´´çº¸,æŠŠè´´çº¸è´´åœ¨çº¸ä¸Š,å…¶ä¸­æŸä¸ªåœ°æ–¹å‘ç”Ÿäº†å˜åŒ–,åªè¦æŠŠé‚£ä¸ªè´´çº¸æ¢æ‰å³å¯
- åœ¨è°·æ­Œæµè§ˆå™¨ä¸­çš„ä½“ç°
  - æ§åˆ¶å° => layers
- åŸºæœ¬æ¦‚å¿µ
  - æµè§ˆå™¨ä¸ä¼šåˆ†å¤ªå¤šå±‚,å› ä¸ºæ¯ä¸ªå›¾å±‚éƒ½ä¼šå ç”¨å†…å­˜,å¦‚æœåˆ†å¤ªå¤šå±‚,å†…å­˜ä¼šå ç”¨å¾ˆå¤š
  - æ¯ä¸ªæµè§ˆå™¨çš„åˆ†å±‚ç­–ç•¥éƒ½ä¸ä¸€æ ·,ç”šè‡³ä¸€ä¸ªæµè§ˆå™¨çš„ä¸åŒç‰ˆæœ¬åˆ†å±‚ç­–ç•¥ä¹Ÿå¯èƒ½ä¸ä¸€æ ·
  - è·Ÿå †å ä¸Šä¸‹æ–‡æœ‰å…³çš„å±æ€§ä¼šå½±å“åˆ†å±‚è§’è‰²(z-indexã€optionã€transformç­‰)
  - æ»šåŠ¨æ¡ä¼šå•ç‹¬åˆ†å‡ºä¸€ä¸ªå±‚
- æˆ‘ä»¬å¦‚æœå¸Œæœ›ä¸€ä¸ªdivå•ç‹¬åˆ†å±‚
  - ç»™æµè§ˆå™¨ä¸€ä¸ªä¿¡æ¯,è®©æµè§ˆå™¨å¸®æˆ‘ä»¬å•ç‹¬åˆ†ä¸€ä¸ªå±‚
  ```css
  div {
    will-change: transform;
  }
  ```
- æ€»ç»“
  - ä¸»çº¿ç¨‹ä¼šä½¿ç”¨ä¸€å¥—å¤æ‚çš„ç­–ç•¥å¯¹æ•´ä¸ªå¸ƒå±€æ ‘è¿›è¡Œåˆ†å±‚,æ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šåˆ†é…åˆ°æŸä¸ªå›¾å±‚
  - åˆ†å±‚çš„å¥½å¤„åœ¨äº,å°†æ¥æŸä¸€ä¸ªå±‚æ”¹å˜å,ä»…ä¼šå¯¹è¯¥å±‚è¿›è¡Œåç»­å¤„ç†,ä»è€Œæå‡æ•ˆç‡
  - æ»šåŠ¨æ¡ã€å †å ä¸Šä¸‹æ–‡ã€transformã€opacityã€åŠ¨ç”»ç­‰éƒ½æ ·å¼éƒ½ä¼šæˆ–å¤šæˆ–å°‘çš„å½±å“åˆ†å±‚ç»“æœ
  - ä¹Ÿå¯ä»¥é€šè¿‡`will-change`å±æ€§æ›´å¤§ç¨‹åº¦çš„å½±å“åˆ†å±‚ç»“æœ
    -  `will-change`ä¸èƒ½æ»¥ç”¨,åªæœ‰æ•ˆç‡å‡ºäº†é—®é¢˜,æ¸²æŸ“å˜å¡äº†,å‘ç°æ˜¯åˆ†å±‚é€ æˆçš„,è¿™ä¸ªåœ°æ–¹ç»å¸¸å˜åŠ¨,ä¸å¸Œæœ›é‡ç»˜çš„è¿‡å¤š,æ‰€ä»¥éœ€è¦å•ç‹¬åˆ†å±‚,æ‰ç”¨è¿™ä¸ªå±æ€§

### ç¬¬äº”é˜¶æ®µ: ç»˜åˆ¶
> è¿™é‡Œçš„ç»˜åˆ¶,æ˜¯ä¸ºæ¯ä¸€å±‚ç”Ÿæˆå¦‚ä½•ç»˜åˆ¶çš„æŒ‡ä»¤
> ä¸»çº¿ç¨‹ä¼šä¸ºæ¯ä¸ªå±‚å•ç‹¬äº§ç”Ÿç»˜åˆ¶æŒ‡ä»¤é›†,ç”¨äºæè¿°è¿™ä¸€å±‚çš„å†…å®¹è¯¥å¦‚ä½•ç”»å‡ºæ¥
> æ¯ä¸ªå±‚ä¼šåˆ†æˆå¾ˆå¤šå°åŒºåŸŸ,æ¯ä¸ªå°åŒºåŸŸéƒ½ä¼šç”Ÿæˆä¸€ä¸ªç»˜åˆ¶æŒ‡ä»¤,è¿™äº›æŒ‡ä»¤ä¼šæŒ‰ç…§é¡ºåºè¢«å‘é€åˆ°GPU,æœ€åç”±GPUè¿›è¡Œç»˜åˆ¶
- ç»˜åˆ¶æŒ‡ä»¤
  - å°†ç¬”ç§»åŠ¨åˆ°æŸä¸ªä½ç½®,ç”»ä¸€æ¡çº¿,ç”»ä¸€ä¸ªåœ†ç­‰
  - ç±»ä¼¼canvas,åªä¸è¿‡canvasæ˜¯jsæ§åˆ¶çš„,è€Œç»˜åˆ¶æŒ‡ä»¤æ˜¯æµè§ˆå™¨æ§åˆ¶çš„
  - canvaså°±æ˜¯æµè§ˆå™¨å¼€æ”¾å‡ºæ¥çš„ç»˜åˆ¶åŠŸèƒ½
  - è¿™é‡Œçš„ç»˜åˆ¶,æ˜¯ä¸ºæ¯ä¸€å±‚ç”Ÿæˆå¦‚ä½•ç»˜åˆ¶çš„æŒ‡ä»¤
- ç»˜åˆ¶å®Œä¹‹å,æ¸²æŸ“ä¸»çº¿ç¨‹çš„å·¥ä½œåˆ°æ­¤ä¸ºæ­¢,å‰©ä½™æ­¥éª¤äº¤ç»™å…¶ä»–çº¿ç¨‹å®Œæˆ
- æ€»ç»“æ¸²æŸ“ä¸»çº¿ç¨‹ç›®å‰åšçš„äº‹æƒ…
  - æ¸²æŸ“ä¸»çº¿ç¨‹ => parse(è§£æhtml-äº§ç”Ÿdomæ ‘å’Œcssomæ ‘) => style(æ ·å¼è®¡ç®—) => layout(ç”Ÿæˆå¸ƒå±€æ ‘,ç”Ÿæˆæ¯ä¸ªèŠ‚ç‚¹çš„å‡ ä½•ä¿¡æ¯) => layer(æ ¹æ®å¸ƒå±€æ ‘åˆ†å±‚) => paint(åˆ†å±‚ä¹‹å,å¯¹æ¯ä¸€å±‚ç”Ÿæˆç»˜åˆ¶æŒ‡ä»¤[å‡ ä½•ä¿¡æ¯éƒ½çŸ¥é“äº†,å°±çŸ¥é“æ€ä¹ˆå»ç”»äº†])
- å¯¹æ¯ä¸€å±‚ç”Ÿæˆç»˜åˆ¶æŒ‡ä»¤ä¹‹å,å°†è¿™äº›æŒ‡ä»¤å‘é€ç»™åˆæˆçº¿ç¨‹
  - åˆæˆçº¿ç¨‹ä¹Ÿåœ¨æ¸²æŸ“è¿›ç¨‹é‡Œé¢

### ç¬¬å…­é˜¶æ®µ: åˆ†å—
> Tiling
> åˆ†å—ä¼šå°†æ¯ä¸€å±‚åˆ†æˆå¤šä¸ªå°åŒºåŸŸ
- åˆæˆçº¿ç¨‹æ˜¯ä¸“é—¨ç”¨æ¥åšåˆ†å—çš„
  - åˆæˆçº¿ç¨‹ä¼šå¯åŠ¨æ›´å¤šçš„çº¿ç¨‹,æ¥ä¸€èµ·è¿›è¡Œåˆ†å—(åˆ†å—å™¨)
- macæ€ä¹ˆçœ‹æµè§ˆå™¨è¿›ç¨‹
  - æœç´¢ => æ´»åŠ¨ç›‘è§†å™¨ => é€‰æ‹©è°·æ­Œæµè§ˆå™¨ => ç‚¹å‡»ä¸Šé¢ä¸‰ä¸ªç‚¹ => å–æ ·è¿›ç¨‹ => é€‰æ‹©çº¿ç¨‹çš„ç™¾åˆ†æ¯”
  - threadå°±æ˜¯ä¸€ä¸ªä¸ªçº¿ç¨‹
  - å…¶ä¸­compositorå°±æ˜¯åˆæˆçº¿ç¨‹,compositorTileWorker1å°±æ˜¯åˆ†å—å™¨,ä¼šæœ‰å¾ˆå¤šåˆ†å—å™¨
- æ€»ç»“
  - å®Œæˆç»˜åˆ¶ä¹‹å,ä¸»çº¿ç¨‹ä¼šå°†æ¯ä¸ªå›¾å±‚çš„ç»˜åˆ¶ä¿¡æ¯æäº¤ç»™åˆæˆçº¿ç¨‹,å‰©ä½™å·¥ä½œå°†ç”±åˆæˆçº¿ç¨‹å®Œæˆ
  - åˆæˆçº¿ç¨‹é¦–å…ˆå¯¹æ¯ä¸ªå›¾å±‚è¿›è¡Œåˆ†å—,å°†å…¶åˆ’åˆ†ä¸ºæ›´å¤šçš„å°åŒºåŸŸ
  - ä»–ä¼šä»çº¿ç¨‹æ± ä¸­æ‹¿å–å¤šä¸ªçº¿ç¨‹æ¥å®Œæˆåˆ†å—å·¥ä½œ
    - çº¿ç¨‹æ± : åœ¨è¿›ç¨‹ä¸­,çº¿ç¨‹æ˜¯å¹²æ´»çš„äºº,çº¿ç¨‹ä¸èƒ½å¼€è¾Ÿçš„å¤ªå¤š,çº¿ç¨‹æ± å°±æ˜¯çº¿ç¨‹çš„ç®¡ç†è€…(ç±»ä¼¼äººæ‰å¸‚åœº)

### ç¬¬ä¸ƒé˜¶æ®µ: å…‰æ …åŒ–
> å…‰æ …åŒ–å°±æ˜¯å°†æ¯ä¸ªå°åŒºåŸŸ(ä¸Šä¸ªæ­¥éª¤çš„åˆ†å—)è½¬åŒ–ä¸ºä½å›¾
> ä¼˜å…ˆå¤„ç†é è¿‘è§†å£(å±å¹•)çš„å—
> åˆæˆè¿›ç¨‹åœ¨å…‰æ …åŒ–çš„æ—¶å€™,ä¼šå°†å·¥ä½œåˆ†é…ç»™gpuè¿›ç¨‹,è®©gpuè¿›ç¨‹å»å®Œæˆå…‰æ …åŒ–,æœ€ç»ˆå…‰æ …åŒ–çš„ç»“æœä¼šç”Ÿæˆä½å›¾,å†å°†ä¸€å—å—ä½å›¾äº¤è¿˜ç»™åˆæˆçº¿ç¨‹
- åŸºæœ¬æ¦‚å¿µ
  - ä»€ä¹ˆæ˜¯ä½å›¾
    - ä½å›¾ç›¸å½“äºå°±æ˜¯åƒç´ ç‚¹ä¿¡æ¯äº†
    - ä½å›¾å¯ä»¥ç†è§£ä¸ºå†…å­˜ä¸­çš„äºŒç»´æ•°ç»„,é‡Œé¢è®°å½•äº†æ¯ä¸ªåƒç´ ç‚¹çš„é¢œè‰²
  - å…‰æ …åŒ–æ˜¯åœ¨GPUä¸­å®Œæˆçš„
    - æ­¤è¿‡ç¨‹ä¼šç”¨åˆ°gpuåŠ é€Ÿ
    - gpuè¿ç®—é€Ÿåº¦,è¶…å‡ºcpuå¾ˆå¤š,gpuèƒ½å¹²çš„äº‹,cpuä¹Ÿèƒ½å¹²,åªä¸è¿‡é€Ÿåº¦æ…¢,ä½†cpuèƒ½å¹²çš„äº‹,gpuä¸ä¸€å®šèƒ½å¹²
    - gpuåªåšä¸æ˜¾ç¤ºç›¸å…³çš„è¿ç®—(å› ä¸ºä¸“æ³¨äºåšæ˜¾ç¤ºç›¸å…³çš„äº‹æƒ…,æ‰€ä»¥é€Ÿåº¦å¿«)
    - gpuä¼šå¢åŠ å…‰æ …åŒ–çš„è¿ç®—é€Ÿåº¦,å³è®¡ç®—åƒç´ å—çš„è¿ç®—é€Ÿåº¦
- æ€»ç»“
  - åˆ†å—å®Œæˆä¹‹å,è¿›å…¥å…‰æ …åŒ–é˜¶æ®µ
  - åˆæˆçº¿ç¨‹ä¼šå°†å—ä¿¡æ¯äº¤ç»™gpuè¿›ç¨‹,ä»¥æé«˜çš„é€Ÿåº¦å®Œæˆå…‰æ …åŒ–
  - gpuè¿›ç¨‹ä¼šå¼€å¯å¤šä¸ªçº¿ç¨‹æ¥å®Œæˆå…‰æ …åŒ–,å¹¶ä¸”ä¼˜å…ˆå¤„ç†é è¿‘è§†å£åŒºåŸŸçš„å—
  - å…‰æ …åŒ–çš„ç»“æœ,å°±æ˜¯ä¸€å—ä¸€å—çš„ä½å›¾

### ç¬¬å…«é˜¶æ®µ: ç”»
> åˆæˆçº¿ç¨‹è®¡ç®—å‡ºæ¯ä¸ªä½å›¾åœ¨å±å¹•ä¸Šçš„ä½ç½®,äº¤ç»™gpuè¿›è¡Œæœ€ç»ˆå‘ˆç°
> draw quad
- åŸºæœ¬ä¿¡æ¯
  - quad
    - æ¯ä¸€ä¸ªå—,å½¢æˆçš„ä½å›¾(æœ‰é¢œè‰²),è¿™ä¸ªä½å›¾ç›¸å¯¹åœ¨å±å¹•ä¸Šçš„ä½ç½®ä¿¡æ¯,å°±æ˜¯quad
  - ç”Ÿæˆçš„quadä¿¡æ¯ä¼šäº¤ç»™gpuè¿›ç¨‹,gpuå†äº¤ç»™çœŸå®çš„ç¡¬ä»¶æ˜¾å¡
  - æœ€ç»ˆæ˜¾å¡å°†è¿™äº›åƒç´ ç‚¹ä¿¡æ¯,æŒ‰ç…§ä½ç½®,åœ¨å±å¹•ä¸Šæ˜¾ç¤ºå‡ºæ¥
- ä¸ºä»€ä¹ˆåˆæˆçº¿ç¨‹ä¸ç›´æ¥äº¤ç»™ç¡¬ä»¶,è€Œæ˜¯è¦äº¤ç»™gpué‡Œé¢ä¸­è½¬ä¸€ä¸‹å‘¢
  - gpuè¿›ç¨‹å®é™…ä¸Šæ˜¯æµè§ˆå™¨çš„è¿›ç¨‹,è¦ç”±æµè§ˆå™¨çš„è¿›ç¨‹äº¤ç»™çœŸå®çš„ç¡¬ä»¶
  - å› ä¸ºåˆæˆçº¿ç¨‹,å’Œæ¸²æŸ“ä¸»çº¿ç¨‹,åœ¨æ¸²æŸ“è¿›ç¨‹é‡Œé¢,æ¸²æŸ“è¿›ç¨‹æ˜¯æ”¾åœ¨ä¸€ä¸ªæ²™ç›’é‡Œé¢çš„,ä»–å’Œæ“ä½œç³»ç»Ÿçš„ç¡¬ä»¶æ˜¯éš”ç¦»çš„,è¿™æ ·çš„å¥½å¤„åœ¨äºå®‰å…¨
    - å¦‚æœè£…äº†æ¶æ„æ’ä»¶,å½±å“ä¸åˆ°æ“ä½œç³»ç»Ÿ
  - æ‰¾gpuçš„è¿‡ç¨‹å«åšç³»ç»Ÿè°ƒç”¨,å³è°ƒç”¨æ“ä½œç³»ç»Ÿçš„æ¥å£
- transform(å˜å½¢)è¯¥æ€ä¹ˆåœ¨é¡µé¢ç”»å‡ºæ¥
  - ç¡®å®šå˜å½¢æ€ä¹ˆåœ¨é¡µé¢ç”»å‡ºæ¥,è¿™ä¸ªæ­¥éª¤æ˜¯åœ¨ç¬¬å…«æ­¥ç¡®å®šçš„
  - ä¸»è¦æ˜¯ä½¿ç”¨æ•°å­¦è¿ç®—(çŸ©é˜µè¿ç®—)å®ç°çš„
  - transformæ¯”opacityé«˜æ•ˆ
  - opacityå’ŒtransformåŠ¨ç”»çš„é«˜æ€§èƒ½æ˜¯ç”±äºå…¶æ•°å­¦åŸç†å†³å®šäº†å¯ä»¥ä½¿ç”¨ç¼“å­˜ä¿¡æ¯ï¼Œè€Œå¹¶ä¸æ˜¯å› ä¸ºå®ƒè¢«ç¡¬ä»¶åŠ é€Ÿäº†
- æ€»ç»“
  - æœ€åä¸€ä¸ªé˜¶æ®µå°±æ˜¯ç”»äº†
  - åˆæˆçº¿ç¨‹æ‹¿åˆ°æ¯ä¸ªå±‚,æ¯ä¸ªå—çš„ä½å›¾å,ç”Ÿæˆä¸€ä¸ªä¸ªæŒ‡å¼•(quad)ä¿¡æ¯
  - æŒ‡å¼•ä¼šæ ‡è¯†å‡ºæ¯ä¸ªä½å›¾åº”è¯¥ç”»åˆ°å±å¹•çš„å“ªä¸ªä½ç½®,ä»¥åŠä¼šè€ƒè™‘åˆ°æ—‹è½¬ã€ç¼©æ”¾ç­‰å˜å½¢
  - å˜å½¢å‘ç”Ÿåœ¨åˆæˆçº¿ç¨‹,ä¸æ¸²æŸ“ä¸»çº¿ç¨‹æ— å…³,è¿™å°±æ˜¯transformæ•ˆç‡é«˜çš„æœ¬è´¨åŸå› (ğŸŒŸ)
  - åˆæˆçº¿ç¨‹ä¼šæŠŠquadæäº¤ç»™gpuè¿›ç¨‹,ç”±gpuè¿›ç¨‹äº§ç”Ÿç³»ç»Ÿè°ƒç”¨,æäº¤ç»™gpuç¡¬ä»¶,å®Œæˆæœ€ç»ˆçš„å±å¹•æˆåƒ

### æ€»ç»“
1. è§£æHTML(parse): æ¸²æŸ“ä¸»çº¿ç¨‹è§£æhtml,ç”Ÿæˆdomæ ‘å’Œcssomæ ‘ 
2. æ ·å¼è®¡ç®— (style): è®¡ç®—æ ·å¼,è®¡ç®—æ¯ä¸ªdomèŠ‚ç‚¹çš„æœ€ç»ˆæ ·å¼,ä½¿æ¯ä¸ªdomèŠ‚ç‚¹æ‹¥éƒ½æœ‰æ ·å¼ä¿¡æ¯
3. å¸ƒå±€(layout): è®¡ç®—æ¯ä¸ªdomèŠ‚ç‚¹çš„å‡ ä½•ä¿¡æ¯,ç”Ÿæˆå¸ƒå±€æ ‘
4. åˆ†å±‚(layer): ä¸ºäº†æå‡åç»­çš„æ¸²æŸ“æ•ˆç‡,å°†é¡µé¢æ ¹æ®æŸä¸ªç­–ç•¥(æ¯ä¸ªæµè§ˆå™¨ä¸åŒ)åˆ†æˆå¤šä¸ªå›¾å±‚,æ¯ä¸ªå±‚å¯ä»¥å•ç‹¬è¿›è¡Œç»˜åˆ¶
5. ç»˜åˆ¶(paint): äº§ç”Ÿç»˜åˆ¶æŒ‡ä»¤(å…ˆç”»å•¥,å†ç”»å•¥,å“ªä¸ªä½ç½®ç”»å•¥)
6. åˆ†å—(tiling): å°†ç»˜åˆ¶æŒ‡ä»¤,äº¤ç»™åˆæˆçº¿ç¨‹çš„åˆ†å—
7. å…‰æ …åŒ–(raster): åˆ†å—å®Œæˆä¹‹å,å½¢æˆå¾ˆå¤šçš„å°å—,ä¹‹åå¯¹æ¯ä¸€ä¸ªå±‚çš„æ¯ä¸€ä¸ªå°å—è¿›è¡Œå…‰æ …åŒ–,ç”Ÿæˆä½å›¾,ä¼˜å…ˆå…‰æ …åŒ–é è¿‘è§†å£(å±å¹•)çš„åŒºåŸŸ
8. ç”»(draw): æœ€åå°†é‚£äº›é è¿‘å±å¹•çš„å°å—å‘é€ç»™gpuè¿›ç¨‹,ç”±gpuè¿›ç¨‹äº§ç”Ÿç³»ç»Ÿè°ƒç”¨,æäº¤ç»™gpuç¡¬ä»¶,å®Œæˆæœ€ç»ˆçš„å±å¹•æˆåƒ

### å’Œæ¸²æŸ“ç›¸å…³çš„é¢è¯•é¢˜
#### ä»€ä¹ˆæ˜¯reflow(layoutBlockFlow)
> é‡æ’
- å¦‚æœæˆ‘ä»¬ç”¨jsä¿®æ”¹æ ·å¼,æ¯”å¦‚ä¿®æ”¹äº†å®½åº¦,æˆ‘ä»¬ä¿®æ”¹çš„æ˜¯cssom,è¦é‡æ–°è¿›è¡Œæ ·å¼è®¡ç®—,é‡æ–°ç”Ÿæˆå¸ƒå±€æ ‘,å¯èƒ½ä¹Ÿè¦é‡æ–°åˆ†å±‚,é‡æ–°ç»˜åˆ¶,é‡æ–°åˆ†å—,é‡æ–°å…‰æ …åŒ–,é‡æ–°ç”»,è¿™ä¸ªè¿‡ç¨‹å°±æ˜¯reflow
- flowè¡¨ç¤ºæ’ç‰ˆçš„æ„æ€,reflowå°±æ˜¯é‡æ–°æ’ç‰ˆ(é‡æ’)
- æ‰€ä»¥æˆ‘ä»¬åœ¨ä»£ç é‡Œé¢å°½é‡å‡å°‘å½±å“å‡ ä½•ä¿¡æ¯çš„æ“ä½œ,å¦åˆ™ä¼šé€ æˆé‡æ’
- æ–‡å­—ä¹Ÿæ˜¯æœ‰å‡ ä½•ä¿¡æ¯çš„
- æ€»ç»“
 - reflowçš„æœ¬è´¨å°±æ˜¯é‡æ–°è®¡ç®—laoutæ ‘(å¸ƒå±€æ ‘)
 - å½“è¿›è¡Œäº†ä¼šå½±å“å¸ƒå±€æ ‘çš„æ“ä½œå,éœ€è¦é‡æ–°è®¡ç®—å¸ƒå±€æ ‘,ä¼šå¼•å‘layout
 - ä¸ºäº†é¿å…è¿ç»­çš„å¤šæ¬¡æ“ä½œå¯¼è‡´å¸ƒå±€åå¤è®¡ç®—,æµè§ˆå™¨ä¼šåˆå¹¶è¿™äº›æ“ä½œ,å½“jsä»£ç å…¨éƒ¨å®Œæˆåå†è¿›è¡Œç»Ÿä¸€è®¡ç®—,æ‰€ä»¥,æ”¹åŠ¨å±æ€§é€ æˆçš„reflowæ˜¯å¼‚æ­¥å®Œæˆçš„
 - ä¹ŸåŒæ ·å› ä¸ºå¦‚æ­¤,å½“jsè·å–å¸ƒå±€å±æ€§æ—¶,å°±å¯èƒ½é€ æˆæ— æ³•è·å–åˆ°æœ€æ–°çš„å¸ƒå±€ä¿¡æ¯
 - æµè§ˆå™¨åœ¨åå¤æƒè¡¡ä¸‹,æœ€ç»ˆå†³å®šè·å–å±æ€§ç«‹å³reflow
- å½“æˆ‘ä»¬ä¿®æ”¹äº†domçš„å‡ ä½•ä¿¡æ¯,æµè§ˆå™¨ä¸ºäº†é¿å…è¿ç»­å¤šæ¬¡reflow,ä¼šäº§ç”Ÿä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡,ä½†jsè·å–å‡ ä½•ä¿¡æ¯çš„æ—¶å€™,äº§ç”Ÿçš„æ˜¯åŒæ­¥ä»»åŠ¡,æ‰€ä»¥jsè·å–çš„å‡ ä½•ä¿¡æ¯æœ‰æ—¶å€™å¯èƒ½å¾—åˆ°çš„æ˜¯ä¹‹å‰æ²¡æœ‰ä¿®æ”¹è¿‡çš„å‡ ä½•ä¿¡æ¯
 - æ‰€ä»¥è®¾ç½®çš„æ—¶å€™,æµè§ˆå™¨ä¸ä¼šç«‹å³reflow,ä½†æ˜¯è·å–çš„æ—¶å€™,æµè§ˆå™¨ä¼šç«‹å³reflow

#### ä»€ä¹ˆæ˜¯repaint
> é‡ç»˜
- æ€»ç»“
  - pepaintçš„æœ¬è´¨å°±æ˜¯é‡æ–°æ ¹æ®åˆ†å±‚ä¿¡æ¯è®¡ç®—äº†ç»˜åˆ¶æŒ‡ä»¤
  - å½“æ”¹åŠ¨äº†å¯è§æ ·å¼å,å°±éœ€è¦é‡æ–°è®¡ç®—,ä¼šå¼•å‘repaint
  - ç”±äºå…ƒç´ çš„å¸ƒå±€ä¿¡æ¯ä¹Ÿå±äºå¯è§æ ·å¼,æ‰€ä»¥reflowä¸€å®šä¼šå¼•èµ·repaint

#### ä¸ºä»€ä¹ˆ transform çš„æ•ˆç‡é«˜ï¼Ÿ
- å› ä¸º transform æ—¢ä¸ä¼šå½±å“å¸ƒå±€ä¹Ÿä¸ä¼šå½±å“ç»˜åˆ¶æŒ‡ä»¤ï¼Œå®ƒå½±å“çš„åªæ˜¯æ¸²æŸ“æµç¨‹çš„æœ€åä¸€ä¸ªã€Œdrawã€é˜¶æ®µ
- ç”±äº draw é˜¶æ®µåœ¨åˆæˆçº¿ç¨‹ä¸­ï¼Œæ‰€ä»¥ transform çš„å˜åŒ–å‡ ä¹ä¸ä¼šå½±å“æ¸²æŸ“ä¸»çº¿ç¨‹ã€‚åä¹‹ï¼Œæ¸²æŸ“ä¸»çº¿ç¨‹æ— è®ºå¦‚ä½•å¿™ç¢Œï¼Œä¹Ÿä¸ä¼šå½±å“ transform çš„å˜åŒ–ã€‚
- ç¤ºä¾‹
  - åœ¨è¿›å…¥æ­»å¾ªç¯ä¹‹å,ä½¿ç”¨leftçš„çƒä¼šå¡æ­»,å› ä¸ºleftæ˜¯å‡ ä½•ä¿¡æ¯,ä¼šå¼•å‘reflow,è€Œreflowæ˜¯åŒæ­¥çš„,ä¼šé˜»å¡ä¸»çº¿ç¨‹
  - ä½¿ç”¨transformçš„çƒä¸ä¼šå¡æ­»,å› ä¸ºtransformä¸ä¼šå¼•å‘reflow,åªä¼šå¼•å‘repaint,repaintæ˜¯å¼‚æ­¥çš„,ä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹
  - æ‰€ä»¥æµè§ˆå™¨åˆ†å‡ºäº†ä¸€ä¸ªåˆæˆçº¿ç¨‹,ä¸“é—¨å¤„ç†transform,è¿™æ ·transformå°±ä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹äº†
```js
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>

    <style>
      .ball {
        width: 100px;
        height: 100px;
        background: #f40;
        border-radius: 50%;
        margin: 30px;
      }
      .ball1 {
        animation: move1 1s alternate infinite ease-in-out;
      }
      .ball2 {
        position: fixed;
        left: 0;
        animation: move2 1s alternate infinite ease-in-out;
      }
      @keyframes move1 {
        to {
          transform: translate(100px);
        }
      }
      @keyframes move2 {
        to {
          left: 100px;
        }
      }
    </style>
  </head>
  <body>
    <button id="btn">æ­»å¾ªç¯</button>
    <div class="ball ball1"></div>
    <div class="ball ball2"></div>
    <script>
      function delay(duration) {
        var start = Date.now();
        while (Date.now() - start < duration) {}
      }
      btn.onclick = function () {
        delay(5000);
      };
    </script>
  </body>
</html>
```
- è¡¥å……è¯´æ˜
  - æµè§ˆå™¨çš„æ»šåŠ¨æ¡,æ»šåŠ¨æ¡ä¹Ÿæ˜¯ä¼šå¼•å‘repaintçš„,æ²¡æœ‰æ”¹å˜å‡ ä½•ä¿¡æ¯,æ‰€ä»¥ä¸éœ€è¦é‡æ–°è®¡ç®—å¸ƒå±€æ ‘,ä¸éœ€è¦é‡æ–°åˆ†å—ç­‰æ­¥éª¤,åªéœ€è¦åœ¨åˆæˆçº¿ç¨‹ä¸­é‡æ–°ç”»ä¸€éå³å¯,æ‰€ä»¥æ»šåŠ¨æ¡ä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹,åœ¨æ¸²æŸ“ä¸»çº¿ç¨‹æ­»å¾ªç¯çš„æ—¶å€™,æ»šåŠ¨æ¡ç…§æ ·å¯ä»¥æ»šåŠ¨,æ»šåŠ¨æ¡ä¸åœ¨æ¸²æŸ“ä¸»çº¿ç¨‹ä¸­